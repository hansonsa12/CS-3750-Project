{"ast":null,"code":"'use strict';\n\nmodule.exports = function (Chart) {\n  var helpers = Chart.helpers;\n  /**\n  \t * Helper method to merge the opacity into a color\n  \t */\n\n  function mergeOpacity(colorString, opacity) {\n    var color = helpers.color(colorString);\n    return color.alpha(opacity * color.alpha()).rgbaString();\n  }\n\n  Chart.defaults.global.tooltips = {\n    enabled: true,\n    custom: null,\n    mode: 'nearest',\n    position: 'average',\n    intersect: true,\n    backgroundColor: 'rgba(0,0,0,0.8)',\n    titleFontStyle: 'bold',\n    titleSpacing: 2,\n    titleMarginBottom: 6,\n    titleFontColor: '#fff',\n    titleAlign: 'left',\n    bodySpacing: 2,\n    bodyFontColor: '#fff',\n    bodyAlign: 'left',\n    footerFontStyle: 'bold',\n    footerSpacing: 2,\n    footerMarginTop: 6,\n    footerFontColor: '#fff',\n    footerAlign: 'left',\n    yPadding: 6,\n    xPadding: 6,\n    caretSize: 5,\n    cornerRadius: 6,\n    multiKeyBackground: '#fff',\n    displayColors: true,\n    callbacks: {\n      // Args are: (tooltipItems, data)\n      beforeTitle: helpers.noop,\n      title: function (tooltipItems, data) {\n        // Pick first xLabel for now\n        var title = '';\n        var labels = data.labels;\n        var labelCount = labels ? labels.length : 0;\n\n        if (tooltipItems.length > 0) {\n          var item = tooltipItems[0];\n\n          if (item.xLabel) {\n            title = item.xLabel;\n          } else if (labelCount > 0 && item.index < labelCount) {\n            title = labels[item.index];\n          }\n        }\n\n        return title;\n      },\n      afterTitle: helpers.noop,\n      // Args are: (tooltipItems, data)\n      beforeBody: helpers.noop,\n      // Args are: (tooltipItem, data)\n      beforeLabel: helpers.noop,\n      label: function (tooltipItem, data) {\n        var datasetLabel = data.datasets[tooltipItem.datasetIndex].label || '';\n        return datasetLabel + ': ' + tooltipItem.yLabel;\n      },\n      labelColor: function (tooltipItem, chartInstance) {\n        var meta = chartInstance.getDatasetMeta(tooltipItem.datasetIndex);\n        var activeElement = meta.data[tooltipItem.index];\n        var view = activeElement._view;\n        return {\n          borderColor: view.borderColor,\n          backgroundColor: view.backgroundColor\n        };\n      },\n      afterLabel: helpers.noop,\n      // Args are: (tooltipItems, data)\n      afterBody: helpers.noop,\n      // Args are: (tooltipItems, data)\n      beforeFooter: helpers.noop,\n      footer: helpers.noop,\n      afterFooter: helpers.noop\n    }\n  }; // Helper to push or concat based on if the 2nd parameter is an array or not\n\n  function pushOrConcat(base, toPush) {\n    if (toPush) {\n      if (helpers.isArray(toPush)) {\n        // base = base.concat(toPush);\n        Array.prototype.push.apply(base, toPush);\n      } else {\n        base.push(toPush);\n      }\n    }\n\n    return base;\n  } // Private helper to create a tooltip item model\n  // @param element : the chart element (point, arc, bar) to create the tooltip item for\n  // @return : new tooltip item\n\n\n  function createTooltipItem(element) {\n    var xScale = element._xScale;\n    var yScale = element._yScale || element._scale; // handle radar || polarArea charts\n\n    var index = element._index,\n        datasetIndex = element._datasetIndex;\n    return {\n      xLabel: xScale ? xScale.getLabelForIndex(index, datasetIndex) : '',\n      yLabel: yScale ? yScale.getLabelForIndex(index, datasetIndex) : '',\n      index: index,\n      datasetIndex: datasetIndex,\n      x: element._model.x,\n      y: element._model.y\n    };\n  }\n  /**\n   * Helper to get the reset model for the tooltip\n   * @param tooltipOpts {Object} the tooltip options\n   */\n\n\n  function getBaseModel(tooltipOpts) {\n    var globalDefaults = Chart.defaults.global;\n    var getValueOrDefault = helpers.getValueOrDefault;\n    return {\n      // Positioning\n      xPadding: tooltipOpts.xPadding,\n      yPadding: tooltipOpts.yPadding,\n      xAlign: tooltipOpts.xAlign,\n      yAlign: tooltipOpts.yAlign,\n      // Body\n      bodyFontColor: tooltipOpts.bodyFontColor,\n      _bodyFontFamily: getValueOrDefault(tooltipOpts.bodyFontFamily, globalDefaults.defaultFontFamily),\n      _bodyFontStyle: getValueOrDefault(tooltipOpts.bodyFontStyle, globalDefaults.defaultFontStyle),\n      _bodyAlign: tooltipOpts.bodyAlign,\n      bodyFontSize: getValueOrDefault(tooltipOpts.bodyFontSize, globalDefaults.defaultFontSize),\n      bodySpacing: tooltipOpts.bodySpacing,\n      // Title\n      titleFontColor: tooltipOpts.titleFontColor,\n      _titleFontFamily: getValueOrDefault(tooltipOpts.titleFontFamily, globalDefaults.defaultFontFamily),\n      _titleFontStyle: getValueOrDefault(tooltipOpts.titleFontStyle, globalDefaults.defaultFontStyle),\n      titleFontSize: getValueOrDefault(tooltipOpts.titleFontSize, globalDefaults.defaultFontSize),\n      _titleAlign: tooltipOpts.titleAlign,\n      titleSpacing: tooltipOpts.titleSpacing,\n      titleMarginBottom: tooltipOpts.titleMarginBottom,\n      // Footer\n      footerFontColor: tooltipOpts.footerFontColor,\n      _footerFontFamily: getValueOrDefault(tooltipOpts.footerFontFamily, globalDefaults.defaultFontFamily),\n      _footerFontStyle: getValueOrDefault(tooltipOpts.footerFontStyle, globalDefaults.defaultFontStyle),\n      footerFontSize: getValueOrDefault(tooltipOpts.footerFontSize, globalDefaults.defaultFontSize),\n      _footerAlign: tooltipOpts.footerAlign,\n      footerSpacing: tooltipOpts.footerSpacing,\n      footerMarginTop: tooltipOpts.footerMarginTop,\n      // Appearance\n      caretSize: tooltipOpts.caretSize,\n      cornerRadius: tooltipOpts.cornerRadius,\n      backgroundColor: tooltipOpts.backgroundColor,\n      opacity: 0,\n      legendColorBackground: tooltipOpts.multiKeyBackground,\n      displayColors: tooltipOpts.displayColors\n    };\n  }\n  /**\n   * Get the size of the tooltip\n   */\n\n\n  function getTooltipSize(tooltip, model) {\n    var ctx = tooltip._chart.ctx;\n    var height = model.yPadding * 2; // Tooltip Padding\n\n    var width = 0; // Count of all lines in the body\n\n    var body = model.body;\n    var combinedBodyLength = body.reduce(function (count, bodyItem) {\n      return count + bodyItem.before.length + bodyItem.lines.length + bodyItem.after.length;\n    }, 0);\n    combinedBodyLength += model.beforeBody.length + model.afterBody.length;\n    var titleLineCount = model.title.length;\n    var footerLineCount = model.footer.length;\n    var titleFontSize = model.titleFontSize,\n        bodyFontSize = model.bodyFontSize,\n        footerFontSize = model.footerFontSize;\n    height += titleLineCount * titleFontSize; // Title Lines\n\n    height += titleLineCount ? (titleLineCount - 1) * model.titleSpacing : 0; // Title Line Spacing\n\n    height += titleLineCount ? model.titleMarginBottom : 0; // Title's bottom Margin\n\n    height += combinedBodyLength * bodyFontSize; // Body Lines\n\n    height += combinedBodyLength ? (combinedBodyLength - 1) * model.bodySpacing : 0; // Body Line Spacing\n\n    height += footerLineCount ? model.footerMarginTop : 0; // Footer Margin\n\n    height += footerLineCount * footerFontSize; // Footer Lines\n\n    height += footerLineCount ? (footerLineCount - 1) * model.footerSpacing : 0; // Footer Line Spacing\n    // Title width\n\n    var widthPadding = 0;\n\n    var maxLineWidth = function (line) {\n      width = Math.max(width, ctx.measureText(line).width + widthPadding);\n    };\n\n    ctx.font = helpers.fontString(titleFontSize, model._titleFontStyle, model._titleFontFamily);\n    helpers.each(model.title, maxLineWidth); // Body width\n\n    ctx.font = helpers.fontString(bodyFontSize, model._bodyFontStyle, model._bodyFontFamily);\n    helpers.each(model.beforeBody.concat(model.afterBody), maxLineWidth); // Body lines may include some extra width due to the color box\n\n    widthPadding = model.displayColors ? bodyFontSize + 2 : 0;\n    helpers.each(body, function (bodyItem) {\n      helpers.each(bodyItem.before, maxLineWidth);\n      helpers.each(bodyItem.lines, maxLineWidth);\n      helpers.each(bodyItem.after, maxLineWidth);\n    }); // Reset back to 0\n\n    widthPadding = 0; // Footer width\n\n    ctx.font = helpers.fontString(footerFontSize, model._footerFontStyle, model._footerFontFamily);\n    helpers.each(model.footer, maxLineWidth); // Add padding\n\n    width += 2 * model.xPadding;\n    return {\n      width: width,\n      height: height\n    };\n  }\n  /**\n   * Helper to get the alignment of a tooltip given the size\n   */\n\n\n  function determineAlignment(tooltip, size) {\n    var model = tooltip._model;\n    var chart = tooltip._chart;\n    var chartArea = tooltip._chartInstance.chartArea;\n    var xAlign = 'center';\n    var yAlign = 'center';\n\n    if (model.y < size.height) {\n      yAlign = 'top';\n    } else if (model.y > chart.height - size.height) {\n      yAlign = 'bottom';\n    }\n\n    var lf, rf; // functions to determine left, right alignment\n\n    var olf, orf; // functions to determine if left/right alignment causes tooltip to go outside chart\n\n    var yf; // function to get the y alignment if the tooltip goes outside of the left or right edges\n\n    var midX = (chartArea.left + chartArea.right) / 2;\n    var midY = (chartArea.top + chartArea.bottom) / 2;\n\n    if (yAlign === 'center') {\n      lf = function (x) {\n        return x <= midX;\n      };\n\n      rf = function (x) {\n        return x > midX;\n      };\n    } else {\n      lf = function (x) {\n        return x <= size.width / 2;\n      };\n\n      rf = function (x) {\n        return x >= chart.width - size.width / 2;\n      };\n    }\n\n    olf = function (x) {\n      return x + size.width > chart.width;\n    };\n\n    orf = function (x) {\n      return x - size.width < 0;\n    };\n\n    yf = function (y) {\n      return y <= midY ? 'top' : 'bottom';\n    };\n\n    if (lf(model.x)) {\n      xAlign = 'left'; // Is tooltip too wide and goes over the right side of the chart.?\n\n      if (olf(model.x)) {\n        xAlign = 'center';\n        yAlign = yf(model.y);\n      }\n    } else if (rf(model.x)) {\n      xAlign = 'right'; // Is tooltip too wide and goes outside left edge of canvas?\n\n      if (orf(model.x)) {\n        xAlign = 'center';\n        yAlign = yf(model.y);\n      }\n    }\n\n    var opts = tooltip._options;\n    return {\n      xAlign: opts.xAlign ? opts.xAlign : xAlign,\n      yAlign: opts.yAlign ? opts.yAlign : yAlign\n    };\n  }\n  /**\n   * @Helper to get the location a tooltip needs to be placed at given the initial position (via the vm) and the size and alignment\n   */\n\n\n  function getBackgroundPoint(vm, size, alignment) {\n    // Background Position\n    var x = vm.x;\n    var y = vm.y;\n    var caretSize = vm.caretSize,\n        caretPadding = vm.caretPadding,\n        cornerRadius = vm.cornerRadius,\n        xAlign = alignment.xAlign,\n        yAlign = alignment.yAlign,\n        paddingAndSize = caretSize + caretPadding,\n        radiusAndPadding = cornerRadius + caretPadding;\n\n    if (xAlign === 'right') {\n      x -= size.width;\n    } else if (xAlign === 'center') {\n      x -= size.width / 2;\n    }\n\n    if (yAlign === 'top') {\n      y += paddingAndSize;\n    } else if (yAlign === 'bottom') {\n      y -= size.height + paddingAndSize;\n    } else {\n      y -= size.height / 2;\n    }\n\n    if (yAlign === 'center') {\n      if (xAlign === 'left') {\n        x += paddingAndSize;\n      } else if (xAlign === 'right') {\n        x -= paddingAndSize;\n      }\n    } else if (xAlign === 'left') {\n      x -= radiusAndPadding;\n    } else if (xAlign === 'right') {\n      x += radiusAndPadding;\n    }\n\n    return {\n      x: x,\n      y: y\n    };\n  }\n\n  Chart.Tooltip = Chart.Element.extend({\n    initialize: function () {\n      this._model = getBaseModel(this._options);\n    },\n    // Get the title\n    // Args are: (tooltipItem, data)\n    getTitle: function () {\n      var me = this;\n      var opts = me._options;\n      var callbacks = opts.callbacks;\n      var beforeTitle = callbacks.beforeTitle.apply(me, arguments),\n          title = callbacks.title.apply(me, arguments),\n          afterTitle = callbacks.afterTitle.apply(me, arguments);\n      var lines = [];\n      lines = pushOrConcat(lines, beforeTitle);\n      lines = pushOrConcat(lines, title);\n      lines = pushOrConcat(lines, afterTitle);\n      return lines;\n    },\n    // Args are: (tooltipItem, data)\n    getBeforeBody: function () {\n      var lines = this._options.callbacks.beforeBody.apply(this, arguments);\n\n      return helpers.isArray(lines) ? lines : lines !== undefined ? [lines] : [];\n    },\n    // Args are: (tooltipItem, data)\n    getBody: function (tooltipItems, data) {\n      var me = this;\n      var callbacks = me._options.callbacks;\n      var bodyItems = [];\n      helpers.each(tooltipItems, function (tooltipItem) {\n        var bodyItem = {\n          before: [],\n          lines: [],\n          after: []\n        };\n        pushOrConcat(bodyItem.before, callbacks.beforeLabel.call(me, tooltipItem, data));\n        pushOrConcat(bodyItem.lines, callbacks.label.call(me, tooltipItem, data));\n        pushOrConcat(bodyItem.after, callbacks.afterLabel.call(me, tooltipItem, data));\n        bodyItems.push(bodyItem);\n      });\n      return bodyItems;\n    },\n    // Args are: (tooltipItem, data)\n    getAfterBody: function () {\n      var lines = this._options.callbacks.afterBody.apply(this, arguments);\n\n      return helpers.isArray(lines) ? lines : lines !== undefined ? [lines] : [];\n    },\n    // Get the footer and beforeFooter and afterFooter lines\n    // Args are: (tooltipItem, data)\n    getFooter: function () {\n      var me = this;\n      var callbacks = me._options.callbacks;\n      var beforeFooter = callbacks.beforeFooter.apply(me, arguments);\n      var footer = callbacks.footer.apply(me, arguments);\n      var afterFooter = callbacks.afterFooter.apply(me, arguments);\n      var lines = [];\n      lines = pushOrConcat(lines, beforeFooter);\n      lines = pushOrConcat(lines, footer);\n      lines = pushOrConcat(lines, afterFooter);\n      return lines;\n    },\n    update: function (changed) {\n      var me = this;\n      var opts = me._options; // Need to regenerate the model because its faster than using extend and it is necessary due to the optimization in Chart.Element.transition\n      // that does _view = _model if ease === 1. This causes the 2nd tooltip update to set properties in both the view and model at the same time\n      // which breaks any animations.\n\n      var existingModel = me._model;\n      var model = me._model = getBaseModel(opts);\n      var active = me._active;\n      var data = me._data;\n      var chartInstance = me._chartInstance; // In the case where active.length === 0 we need to keep these at existing values for good animations\n\n      var alignment = {\n        xAlign: existingModel.xAlign,\n        yAlign: existingModel.yAlign\n      };\n      var backgroundPoint = {\n        x: existingModel.x,\n        y: existingModel.y\n      };\n      var tooltipSize = {\n        width: existingModel.width,\n        height: existingModel.height\n      };\n      var tooltipPosition = {\n        x: existingModel.caretX,\n        y: existingModel.caretY\n      };\n      var i, len;\n\n      if (active.length) {\n        model.opacity = 1;\n        var labelColors = [];\n        tooltipPosition = Chart.Tooltip.positioners[opts.position](active, me._eventPosition);\n        var tooltipItems = [];\n\n        for (i = 0, len = active.length; i < len; ++i) {\n          tooltipItems.push(createTooltipItem(active[i]));\n        } // If the user provided a filter function, use it to modify the tooltip items\n\n\n        if (opts.filter) {\n          tooltipItems = tooltipItems.filter(function (a) {\n            return opts.filter(a, data);\n          });\n        } // If the user provided a sorting function, use it to modify the tooltip items\n\n\n        if (opts.itemSort) {\n          tooltipItems = tooltipItems.sort(function (a, b) {\n            return opts.itemSort(a, b, data);\n          });\n        } // Determine colors for boxes\n\n\n        helpers.each(tooltipItems, function (tooltipItem) {\n          labelColors.push(opts.callbacks.labelColor.call(me, tooltipItem, chartInstance));\n        }); // Build the Text Lines\n\n        model.title = me.getTitle(tooltipItems, data);\n        model.beforeBody = me.getBeforeBody(tooltipItems, data);\n        model.body = me.getBody(tooltipItems, data);\n        model.afterBody = me.getAfterBody(tooltipItems, data);\n        model.footer = me.getFooter(tooltipItems, data); // Initial positioning and colors\n\n        model.x = Math.round(tooltipPosition.x);\n        model.y = Math.round(tooltipPosition.y);\n        model.caretPadding = helpers.getValueOrDefault(tooltipPosition.padding, 2);\n        model.labelColors = labelColors; // data points\n\n        model.dataPoints = tooltipItems; // We need to determine alignment of the tooltip\n\n        tooltipSize = getTooltipSize(this, model);\n        alignment = determineAlignment(this, tooltipSize); // Final Size and Position\n\n        backgroundPoint = getBackgroundPoint(model, tooltipSize, alignment);\n      } else {\n        model.opacity = 0;\n      }\n\n      model.xAlign = alignment.xAlign;\n      model.yAlign = alignment.yAlign;\n      model.x = backgroundPoint.x;\n      model.y = backgroundPoint.y;\n      model.width = tooltipSize.width;\n      model.height = tooltipSize.height; // Point where the caret on the tooltip points to\n\n      model.caretX = tooltipPosition.x;\n      model.caretY = tooltipPosition.y;\n      me._model = model;\n\n      if (changed && opts.custom) {\n        opts.custom.call(me, model);\n      }\n\n      return me;\n    },\n    drawCaret: function (tooltipPoint, size, opacity) {\n      var vm = this._view;\n      var ctx = this._chart.ctx;\n      var x1, x2, x3;\n      var y1, y2, y3;\n      var caretSize = vm.caretSize;\n      var cornerRadius = vm.cornerRadius;\n      var xAlign = vm.xAlign,\n          yAlign = vm.yAlign;\n      var ptX = tooltipPoint.x,\n          ptY = tooltipPoint.y;\n      var width = size.width,\n          height = size.height;\n\n      if (yAlign === 'center') {\n        // Left or right side\n        if (xAlign === 'left') {\n          x1 = ptX;\n          x2 = x1 - caretSize;\n          x3 = x1;\n        } else {\n          x1 = ptX + width;\n          x2 = x1 + caretSize;\n          x3 = x1;\n        }\n\n        y2 = ptY + height / 2;\n        y1 = y2 - caretSize;\n        y3 = y2 + caretSize;\n      } else {\n        if (xAlign === 'left') {\n          x1 = ptX + cornerRadius;\n          x2 = x1 + caretSize;\n          x3 = x2 + caretSize;\n        } else if (xAlign === 'right') {\n          x1 = ptX + width - cornerRadius;\n          x2 = x1 - caretSize;\n          x3 = x2 - caretSize;\n        } else {\n          x2 = ptX + width / 2;\n          x1 = x2 - caretSize;\n          x3 = x2 + caretSize;\n        }\n\n        if (yAlign === 'top') {\n          y1 = ptY;\n          y2 = y1 - caretSize;\n          y3 = y1;\n        } else {\n          y1 = ptY + height;\n          y2 = y1 + caretSize;\n          y3 = y1;\n        }\n      }\n\n      ctx.fillStyle = mergeOpacity(vm.backgroundColor, opacity);\n      ctx.beginPath();\n      ctx.moveTo(x1, y1);\n      ctx.lineTo(x2, y2);\n      ctx.lineTo(x3, y3);\n      ctx.closePath();\n      ctx.fill();\n    },\n    drawTitle: function (pt, vm, ctx, opacity) {\n      var title = vm.title;\n\n      if (title.length) {\n        ctx.textAlign = vm._titleAlign;\n        ctx.textBaseline = 'top';\n        var titleFontSize = vm.titleFontSize,\n            titleSpacing = vm.titleSpacing;\n        ctx.fillStyle = mergeOpacity(vm.titleFontColor, opacity);\n        ctx.font = helpers.fontString(titleFontSize, vm._titleFontStyle, vm._titleFontFamily);\n        var i, len;\n\n        for (i = 0, len = title.length; i < len; ++i) {\n          ctx.fillText(title[i], pt.x, pt.y);\n          pt.y += titleFontSize + titleSpacing; // Line Height and spacing\n\n          if (i + 1 === title.length) {\n            pt.y += vm.titleMarginBottom - titleSpacing; // If Last, add margin, remove spacing\n          }\n        }\n      }\n    },\n    drawBody: function (pt, vm, ctx, opacity) {\n      var bodyFontSize = vm.bodyFontSize;\n      var bodySpacing = vm.bodySpacing;\n      var body = vm.body;\n      ctx.textAlign = vm._bodyAlign;\n      ctx.textBaseline = 'top';\n      var textColor = mergeOpacity(vm.bodyFontColor, opacity);\n      ctx.fillStyle = textColor;\n      ctx.font = helpers.fontString(bodyFontSize, vm._bodyFontStyle, vm._bodyFontFamily); // Before Body\n\n      var xLinePadding = 0;\n\n      var fillLineOfText = function (line) {\n        ctx.fillText(line, pt.x + xLinePadding, pt.y);\n        pt.y += bodyFontSize + bodySpacing;\n      }; // Before body lines\n\n\n      helpers.each(vm.beforeBody, fillLineOfText);\n      var drawColorBoxes = vm.displayColors;\n      xLinePadding = drawColorBoxes ? bodyFontSize + 2 : 0; // Draw body lines now\n\n      helpers.each(body, function (bodyItem, i) {\n        helpers.each(bodyItem.before, fillLineOfText);\n        helpers.each(bodyItem.lines, function (line) {\n          // Draw Legend-like boxes if needed\n          if (drawColorBoxes) {\n            // Fill a white rect so that colours merge nicely if the opacity is < 1\n            ctx.fillStyle = mergeOpacity(vm.legendColorBackground, opacity);\n            ctx.fillRect(pt.x, pt.y, bodyFontSize, bodyFontSize); // Border\n\n            ctx.strokeStyle = mergeOpacity(vm.labelColors[i].borderColor, opacity);\n            ctx.strokeRect(pt.x, pt.y, bodyFontSize, bodyFontSize); // Inner square\n\n            ctx.fillStyle = mergeOpacity(vm.labelColors[i].backgroundColor, opacity);\n            ctx.fillRect(pt.x + 1, pt.y + 1, bodyFontSize - 2, bodyFontSize - 2);\n            ctx.fillStyle = textColor;\n          }\n\n          fillLineOfText(line);\n        });\n        helpers.each(bodyItem.after, fillLineOfText);\n      }); // Reset back to 0 for after body\n\n      xLinePadding = 0; // After body lines\n\n      helpers.each(vm.afterBody, fillLineOfText);\n      pt.y -= bodySpacing; // Remove last body spacing\n    },\n    drawFooter: function (pt, vm, ctx, opacity) {\n      var footer = vm.footer;\n\n      if (footer.length) {\n        pt.y += vm.footerMarginTop;\n        ctx.textAlign = vm._footerAlign;\n        ctx.textBaseline = 'top';\n        ctx.fillStyle = mergeOpacity(vm.footerFontColor, opacity);\n        ctx.font = helpers.fontString(vm.footerFontSize, vm._footerFontStyle, vm._footerFontFamily);\n        helpers.each(footer, function (line) {\n          ctx.fillText(line, pt.x, pt.y);\n          pt.y += vm.footerFontSize + vm.footerSpacing;\n        });\n      }\n    },\n    drawBackground: function (pt, vm, ctx, tooltipSize, opacity) {\n      ctx.fillStyle = mergeOpacity(vm.backgroundColor, opacity);\n      helpers.drawRoundedRectangle(ctx, pt.x, pt.y, tooltipSize.width, tooltipSize.height, vm.cornerRadius);\n      ctx.fill();\n    },\n    draw: function () {\n      var ctx = this._chart.ctx;\n      var vm = this._view;\n\n      if (vm.opacity === 0) {\n        return;\n      }\n\n      var tooltipSize = {\n        width: vm.width,\n        height: vm.height\n      };\n      var pt = {\n        x: vm.x,\n        y: vm.y\n      }; // IE11/Edge does not like very small opacities, so snap to 0\n\n      var opacity = Math.abs(vm.opacity < 1e-3) ? 0 : vm.opacity;\n\n      if (this._options.enabled) {\n        // Draw Background\n        this.drawBackground(pt, vm, ctx, tooltipSize, opacity); // Draw Caret\n\n        this.drawCaret(pt, tooltipSize, opacity); // Draw Title, Body, and Footer\n\n        pt.x += vm.xPadding;\n        pt.y += vm.yPadding; // Titles\n\n        this.drawTitle(pt, vm, ctx, opacity); // Body\n\n        this.drawBody(pt, vm, ctx, opacity); // Footer\n\n        this.drawFooter(pt, vm, ctx, opacity);\n      }\n    },\n\n    /**\n     * Handle an event\n     * @private\n     * @param {IEvent} event - The event to handle\n     * @returns {Boolean} true if the tooltip changed\n     */\n    handleEvent: function (e) {\n      var me = this;\n      var options = me._options;\n      var changed = false;\n      me._lastActive = me._lastActive || []; // Find Active Elements for tooltips\n\n      if (e.type === 'mouseout') {\n        me._active = [];\n      } else {\n        me._active = me._chartInstance.getElementsAtEventForMode(e, options.mode, options);\n      } // Remember Last Actives\n\n\n      changed = !helpers.arrayEquals(me._active, me._lastActive);\n      me._lastActive = me._active;\n\n      if (options.enabled || options.custom) {\n        me._eventPosition = {\n          x: e.x,\n          y: e.y\n        };\n        var model = me._model;\n        me.update(true);\n        me.pivot(); // See if our tooltip position changed\n\n        changed |= model.x !== me._model.x || model.y !== me._model.y;\n      }\n\n      return changed;\n    }\n  });\n  /**\n   * @namespace Chart.Tooltip.positioners\n   */\n\n  Chart.Tooltip.positioners = {\n    /**\n     * Average mode places the tooltip at the average position of the elements shown\n     * @function Chart.Tooltip.positioners.average\n     * @param elements {ChartElement[]} the elements being displayed in the tooltip\n     * @returns {Point} tooltip position\n     */\n    average: function (elements) {\n      if (!elements.length) {\n        return false;\n      }\n\n      var i, len;\n      var x = 0;\n      var y = 0;\n      var count = 0;\n\n      for (i = 0, len = elements.length; i < len; ++i) {\n        var el = elements[i];\n\n        if (el && el.hasValue()) {\n          var pos = el.tooltipPosition();\n          x += pos.x;\n          y += pos.y;\n          ++count;\n        }\n      }\n\n      return {\n        x: Math.round(x / count),\n        y: Math.round(y / count)\n      };\n    },\n\n    /**\n     * Gets the tooltip position nearest of the item nearest to the event position\n     * @function Chart.Tooltip.positioners.nearest\n     * @param elements {Chart.Element[]} the tooltip elements\n     * @param eventPosition {Point} the position of the event in canvas coordinates\n     * @returns {Point} the tooltip position\n     */\n    nearest: function (elements, eventPosition) {\n      var x = eventPosition.x;\n      var y = eventPosition.y;\n      var nearestElement;\n      var minDistance = Number.POSITIVE_INFINITY;\n      var i, len;\n\n      for (i = 0, len = elements.length; i < len; ++i) {\n        var el = elements[i];\n\n        if (el && el.hasValue()) {\n          var center = el.getCenterPoint();\n          var d = helpers.distanceBetweenPoints(eventPosition, center);\n\n          if (d < minDistance) {\n            minDistance = d;\n            nearestElement = el;\n          }\n        }\n      }\n\n      if (nearestElement) {\n        var tp = nearestElement.tooltipPosition();\n        x = tp.x;\n        y = tp.y;\n      }\n\n      return {\n        x: x,\n        y: y\n      };\n    }\n  };\n};","map":{"version":3,"sources":["C:/Users/Kronos/Documents/Programming/Web/React/CS-3750-Project/ClientApp/node_modules/chart.js/src/core/core.tooltip.js"],"names":["module","exports","Chart","helpers","mergeOpacity","colorString","opacity","color","alpha","rgbaString","defaults","global","tooltips","enabled","custom","mode","position","intersect","backgroundColor","titleFontStyle","titleSpacing","titleMarginBottom","titleFontColor","titleAlign","bodySpacing","bodyFontColor","bodyAlign","footerFontStyle","footerSpacing","footerMarginTop","footerFontColor","footerAlign","yPadding","xPadding","caretSize","cornerRadius","multiKeyBackground","displayColors","callbacks","beforeTitle","noop","title","tooltipItems","data","labels","labelCount","length","item","xLabel","index","afterTitle","beforeBody","beforeLabel","label","tooltipItem","datasetLabel","datasets","datasetIndex","yLabel","labelColor","chartInstance","meta","getDatasetMeta","activeElement","view","_view","borderColor","afterLabel","afterBody","beforeFooter","footer","afterFooter","pushOrConcat","base","toPush","isArray","Array","prototype","push","apply","createTooltipItem","element","xScale","_xScale","yScale","_yScale","_scale","_index","_datasetIndex","getLabelForIndex","x","_model","y","getBaseModel","tooltipOpts","globalDefaults","getValueOrDefault","xAlign","yAlign","_bodyFontFamily","bodyFontFamily","defaultFontFamily","_bodyFontStyle","bodyFontStyle","defaultFontStyle","_bodyAlign","bodyFontSize","defaultFontSize","_titleFontFamily","titleFontFamily","_titleFontStyle","titleFontSize","_titleAlign","_footerFontFamily","footerFontFamily","_footerFontStyle","footerFontSize","_footerAlign","legendColorBackground","getTooltipSize","tooltip","model","ctx","_chart","height","width","body","combinedBodyLength","reduce","count","bodyItem","before","lines","after","titleLineCount","footerLineCount","widthPadding","maxLineWidth","line","Math","max","measureText","font","fontString","each","concat","determineAlignment","size","chart","chartArea","_chartInstance","lf","rf","olf","orf","yf","midX","left","right","midY","top","bottom","opts","_options","getBackgroundPoint","vm","alignment","caretPadding","paddingAndSize","radiusAndPadding","Tooltip","Element","extend","initialize","getTitle","me","arguments","getBeforeBody","undefined","getBody","bodyItems","call","getAfterBody","getFooter","update","changed","existingModel","active","_active","_data","backgroundPoint","tooltipSize","tooltipPosition","caretX","caretY","i","len","labelColors","positioners","_eventPosition","filter","a","itemSort","sort","b","round","padding","dataPoints","drawCaret","tooltipPoint","x1","x2","x3","y1","y2","y3","ptX","ptY","fillStyle","beginPath","moveTo","lineTo","closePath","fill","drawTitle","pt","textAlign","textBaseline","fillText","drawBody","textColor","xLinePadding","fillLineOfText","drawColorBoxes","fillRect","strokeStyle","strokeRect","drawFooter","drawBackground","drawRoundedRectangle","draw","abs","handleEvent","e","options","_lastActive","type","getElementsAtEventForMode","arrayEquals","pivot","average","elements","el","hasValue","pos","nearest","eventPosition","nearestElement","minDistance","Number","POSITIVE_INFINITY","center","getCenterPoint","d","distanceBetweenPoints","tp"],"mappings":"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","sourcesContent":["'use strict';\n\nmodule.exports = function(Chart) {\n\n\tvar helpers = Chart.helpers;\n\n\t/**\n \t * Helper method to merge the opacity into a color\n \t */\n\tfunction mergeOpacity(colorString, opacity) {\n\t\tvar color = helpers.color(colorString);\n\t\treturn color.alpha(opacity * color.alpha()).rgbaString();\n\t}\n\n\tChart.defaults.global.tooltips = {\n\t\tenabled: true,\n\t\tcustom: null,\n\t\tmode: 'nearest',\n\t\tposition: 'average',\n\t\tintersect: true,\n\t\tbackgroundColor: 'rgba(0,0,0,0.8)',\n\t\ttitleFontStyle: 'bold',\n\t\ttitleSpacing: 2,\n\t\ttitleMarginBottom: 6,\n\t\ttitleFontColor: '#fff',\n\t\ttitleAlign: 'left',\n\t\tbodySpacing: 2,\n\t\tbodyFontColor: '#fff',\n\t\tbodyAlign: 'left',\n\t\tfooterFontStyle: 'bold',\n\t\tfooterSpacing: 2,\n\t\tfooterMarginTop: 6,\n\t\tfooterFontColor: '#fff',\n\t\tfooterAlign: 'left',\n\t\tyPadding: 6,\n\t\txPadding: 6,\n\t\tcaretSize: 5,\n\t\tcornerRadius: 6,\n\t\tmultiKeyBackground: '#fff',\n\t\tdisplayColors: true,\n\t\tcallbacks: {\n\t\t\t// Args are: (tooltipItems, data)\n\t\t\tbeforeTitle: helpers.noop,\n\t\t\ttitle: function(tooltipItems, data) {\n\t\t\t\t// Pick first xLabel for now\n\t\t\t\tvar title = '';\n\t\t\t\tvar labels = data.labels;\n\t\t\t\tvar labelCount = labels ? labels.length : 0;\n\n\t\t\t\tif (tooltipItems.length > 0) {\n\t\t\t\t\tvar item = tooltipItems[0];\n\n\t\t\t\t\tif (item.xLabel) {\n\t\t\t\t\t\ttitle = item.xLabel;\n\t\t\t\t\t} else if (labelCount > 0 && item.index < labelCount) {\n\t\t\t\t\t\ttitle = labels[item.index];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn title;\n\t\t\t},\n\t\t\tafterTitle: helpers.noop,\n\n\t\t\t// Args are: (tooltipItems, data)\n\t\t\tbeforeBody: helpers.noop,\n\n\t\t\t// Args are: (tooltipItem, data)\n\t\t\tbeforeLabel: helpers.noop,\n\t\t\tlabel: function(tooltipItem, data) {\n\t\t\t\tvar datasetLabel = data.datasets[tooltipItem.datasetIndex].label || '';\n\t\t\t\treturn datasetLabel + ': ' + tooltipItem.yLabel;\n\t\t\t},\n\t\t\tlabelColor: function(tooltipItem, chartInstance) {\n\t\t\t\tvar meta = chartInstance.getDatasetMeta(tooltipItem.datasetIndex);\n\t\t\t\tvar activeElement = meta.data[tooltipItem.index];\n\t\t\t\tvar view = activeElement._view;\n\t\t\t\treturn {\n\t\t\t\t\tborderColor: view.borderColor,\n\t\t\t\t\tbackgroundColor: view.backgroundColor\n\t\t\t\t};\n\t\t\t},\n\t\t\tafterLabel: helpers.noop,\n\n\t\t\t// Args are: (tooltipItems, data)\n\t\t\tafterBody: helpers.noop,\n\n\t\t\t// Args are: (tooltipItems, data)\n\t\t\tbeforeFooter: helpers.noop,\n\t\t\tfooter: helpers.noop,\n\t\t\tafterFooter: helpers.noop\n\t\t}\n\t};\n\n\t// Helper to push or concat based on if the 2nd parameter is an array or not\n\tfunction pushOrConcat(base, toPush) {\n\t\tif (toPush) {\n\t\t\tif (helpers.isArray(toPush)) {\n\t\t\t\t// base = base.concat(toPush);\n\t\t\t\tArray.prototype.push.apply(base, toPush);\n\t\t\t} else {\n\t\t\t\tbase.push(toPush);\n\t\t\t}\n\t\t}\n\n\t\treturn base;\n\t}\n\n\t// Private helper to create a tooltip item model\n\t// @param element : the chart element (point, arc, bar) to create the tooltip item for\n\t// @return : new tooltip item\n\tfunction createTooltipItem(element) {\n\t\tvar xScale = element._xScale;\n\t\tvar yScale = element._yScale || element._scale; // handle radar || polarArea charts\n\t\tvar index = element._index,\n\t\t\tdatasetIndex = element._datasetIndex;\n\n\t\treturn {\n\t\t\txLabel: xScale ? xScale.getLabelForIndex(index, datasetIndex) : '',\n\t\t\tyLabel: yScale ? yScale.getLabelForIndex(index, datasetIndex) : '',\n\t\t\tindex: index,\n\t\t\tdatasetIndex: datasetIndex,\n\t\t\tx: element._model.x,\n\t\t\ty: element._model.y\n\t\t};\n\t}\n\n\t/**\n\t * Helper to get the reset model for the tooltip\n\t * @param tooltipOpts {Object} the tooltip options\n\t */\n\tfunction getBaseModel(tooltipOpts) {\n\t\tvar globalDefaults = Chart.defaults.global;\n\t\tvar getValueOrDefault = helpers.getValueOrDefault;\n\n\t\treturn {\n\t\t\t// Positioning\n\t\t\txPadding: tooltipOpts.xPadding,\n\t\t\tyPadding: tooltipOpts.yPadding,\n\t\t\txAlign: tooltipOpts.xAlign,\n\t\t\tyAlign: tooltipOpts.yAlign,\n\n\t\t\t// Body\n\t\t\tbodyFontColor: tooltipOpts.bodyFontColor,\n\t\t\t_bodyFontFamily: getValueOrDefault(tooltipOpts.bodyFontFamily, globalDefaults.defaultFontFamily),\n\t\t\t_bodyFontStyle: getValueOrDefault(tooltipOpts.bodyFontStyle, globalDefaults.defaultFontStyle),\n\t\t\t_bodyAlign: tooltipOpts.bodyAlign,\n\t\t\tbodyFontSize: getValueOrDefault(tooltipOpts.bodyFontSize, globalDefaults.defaultFontSize),\n\t\t\tbodySpacing: tooltipOpts.bodySpacing,\n\n\t\t\t// Title\n\t\t\ttitleFontColor: tooltipOpts.titleFontColor,\n\t\t\t_titleFontFamily: getValueOrDefault(tooltipOpts.titleFontFamily, globalDefaults.defaultFontFamily),\n\t\t\t_titleFontStyle: getValueOrDefault(tooltipOpts.titleFontStyle, globalDefaults.defaultFontStyle),\n\t\t\ttitleFontSize: getValueOrDefault(tooltipOpts.titleFontSize, globalDefaults.defaultFontSize),\n\t\t\t_titleAlign: tooltipOpts.titleAlign,\n\t\t\ttitleSpacing: tooltipOpts.titleSpacing,\n\t\t\ttitleMarginBottom: tooltipOpts.titleMarginBottom,\n\n\t\t\t// Footer\n\t\t\tfooterFontColor: tooltipOpts.footerFontColor,\n\t\t\t_footerFontFamily: getValueOrDefault(tooltipOpts.footerFontFamily, globalDefaults.defaultFontFamily),\n\t\t\t_footerFontStyle: getValueOrDefault(tooltipOpts.footerFontStyle, globalDefaults.defaultFontStyle),\n\t\t\tfooterFontSize: getValueOrDefault(tooltipOpts.footerFontSize, globalDefaults.defaultFontSize),\n\t\t\t_footerAlign: tooltipOpts.footerAlign,\n\t\t\tfooterSpacing: tooltipOpts.footerSpacing,\n\t\t\tfooterMarginTop: tooltipOpts.footerMarginTop,\n\n\t\t\t// Appearance\n\t\t\tcaretSize: tooltipOpts.caretSize,\n\t\t\tcornerRadius: tooltipOpts.cornerRadius,\n\t\t\tbackgroundColor: tooltipOpts.backgroundColor,\n\t\t\topacity: 0,\n\t\t\tlegendColorBackground: tooltipOpts.multiKeyBackground,\n\t\t\tdisplayColors: tooltipOpts.displayColors\n\t\t};\n\t}\n\n\t/**\n\t * Get the size of the tooltip\n\t */\n\tfunction getTooltipSize(tooltip, model) {\n\t\tvar ctx = tooltip._chart.ctx;\n\n\t\tvar height = model.yPadding * 2; // Tooltip Padding\n\t\tvar width = 0;\n\n\t\t// Count of all lines in the body\n\t\tvar body = model.body;\n\t\tvar combinedBodyLength = body.reduce(function(count, bodyItem) {\n\t\t\treturn count + bodyItem.before.length + bodyItem.lines.length + bodyItem.after.length;\n\t\t}, 0);\n\t\tcombinedBodyLength += model.beforeBody.length + model.afterBody.length;\n\n\t\tvar titleLineCount = model.title.length;\n\t\tvar footerLineCount = model.footer.length;\n\t\tvar titleFontSize = model.titleFontSize,\n\t\t\tbodyFontSize = model.bodyFontSize,\n\t\t\tfooterFontSize = model.footerFontSize;\n\n\t\theight += titleLineCount * titleFontSize; // Title Lines\n\t\theight += titleLineCount ? (titleLineCount - 1) * model.titleSpacing : 0; // Title Line Spacing\n\t\theight += titleLineCount ? model.titleMarginBottom : 0; // Title's bottom Margin\n\t\theight += combinedBodyLength * bodyFontSize; // Body Lines\n\t\theight += combinedBodyLength ? (combinedBodyLength - 1) * model.bodySpacing : 0; // Body Line Spacing\n\t\theight += footerLineCount ? model.footerMarginTop : 0; // Footer Margin\n\t\theight += footerLineCount * (footerFontSize); // Footer Lines\n\t\theight += footerLineCount ? (footerLineCount - 1) * model.footerSpacing : 0; // Footer Line Spacing\n\n\t\t// Title width\n\t\tvar widthPadding = 0;\n\t\tvar maxLineWidth = function(line) {\n\t\t\twidth = Math.max(width, ctx.measureText(line).width + widthPadding);\n\t\t};\n\n\t\tctx.font = helpers.fontString(titleFontSize, model._titleFontStyle, model._titleFontFamily);\n\t\thelpers.each(model.title, maxLineWidth);\n\n\t\t// Body width\n\t\tctx.font = helpers.fontString(bodyFontSize, model._bodyFontStyle, model._bodyFontFamily);\n\t\thelpers.each(model.beforeBody.concat(model.afterBody), maxLineWidth);\n\n\t\t// Body lines may include some extra width due to the color box\n\t\twidthPadding = model.displayColors ? (bodyFontSize + 2) : 0;\n\t\thelpers.each(body, function(bodyItem) {\n\t\t\thelpers.each(bodyItem.before, maxLineWidth);\n\t\t\thelpers.each(bodyItem.lines, maxLineWidth);\n\t\t\thelpers.each(bodyItem.after, maxLineWidth);\n\t\t});\n\n\t\t// Reset back to 0\n\t\twidthPadding = 0;\n\n\t\t// Footer width\n\t\tctx.font = helpers.fontString(footerFontSize, model._footerFontStyle, model._footerFontFamily);\n\t\thelpers.each(model.footer, maxLineWidth);\n\n\t\t// Add padding\n\t\twidth += 2 * model.xPadding;\n\n\t\treturn {\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t};\n\t}\n\n\t/**\n\t * Helper to get the alignment of a tooltip given the size\n\t */\n\tfunction determineAlignment(tooltip, size) {\n\t\tvar model = tooltip._model;\n\t\tvar chart = tooltip._chart;\n\t\tvar chartArea = tooltip._chartInstance.chartArea;\n\t\tvar xAlign = 'center';\n\t\tvar yAlign = 'center';\n\n\t\tif (model.y < size.height) {\n\t\t\tyAlign = 'top';\n\t\t} else if (model.y > (chart.height - size.height)) {\n\t\t\tyAlign = 'bottom';\n\t\t}\n\n\t\tvar lf, rf; // functions to determine left, right alignment\n\t\tvar olf, orf; // functions to determine if left/right alignment causes tooltip to go outside chart\n\t\tvar yf; // function to get the y alignment if the tooltip goes outside of the left or right edges\n\t\tvar midX = (chartArea.left + chartArea.right) / 2;\n\t\tvar midY = (chartArea.top + chartArea.bottom) / 2;\n\n\t\tif (yAlign === 'center') {\n\t\t\tlf = function(x) {\n\t\t\t\treturn x <= midX;\n\t\t\t};\n\t\t\trf = function(x) {\n\t\t\t\treturn x > midX;\n\t\t\t};\n\t\t} else {\n\t\t\tlf = function(x) {\n\t\t\t\treturn x <= (size.width / 2);\n\t\t\t};\n\t\t\trf = function(x) {\n\t\t\t\treturn x >= (chart.width - (size.width / 2));\n\t\t\t};\n\t\t}\n\n\t\tolf = function(x) {\n\t\t\treturn x + size.width > chart.width;\n\t\t};\n\t\torf = function(x) {\n\t\t\treturn x - size.width < 0;\n\t\t};\n\t\tyf = function(y) {\n\t\t\treturn y <= midY ? 'top' : 'bottom';\n\t\t};\n\n\t\tif (lf(model.x)) {\n\t\t\txAlign = 'left';\n\n\t\t\t// Is tooltip too wide and goes over the right side of the chart.?\n\t\t\tif (olf(model.x)) {\n\t\t\t\txAlign = 'center';\n\t\t\t\tyAlign = yf(model.y);\n\t\t\t}\n\t\t} else if (rf(model.x)) {\n\t\t\txAlign = 'right';\n\n\t\t\t// Is tooltip too wide and goes outside left edge of canvas?\n\t\t\tif (orf(model.x)) {\n\t\t\t\txAlign = 'center';\n\t\t\t\tyAlign = yf(model.y);\n\t\t\t}\n\t\t}\n\n\t\tvar opts = tooltip._options;\n\t\treturn {\n\t\t\txAlign: opts.xAlign ? opts.xAlign : xAlign,\n\t\t\tyAlign: opts.yAlign ? opts.yAlign : yAlign\n\t\t};\n\t}\n\n\t/**\n\t * @Helper to get the location a tooltip needs to be placed at given the initial position (via the vm) and the size and alignment\n\t */\n\tfunction getBackgroundPoint(vm, size, alignment) {\n\t\t// Background Position\n\t\tvar x = vm.x;\n\t\tvar y = vm.y;\n\n\t\tvar caretSize = vm.caretSize,\n\t\t\tcaretPadding = vm.caretPadding,\n\t\t\tcornerRadius = vm.cornerRadius,\n\t\t\txAlign = alignment.xAlign,\n\t\t\tyAlign = alignment.yAlign,\n\t\t\tpaddingAndSize = caretSize + caretPadding,\n\t\t\tradiusAndPadding = cornerRadius + caretPadding;\n\n\t\tif (xAlign === 'right') {\n\t\t\tx -= size.width;\n\t\t} else if (xAlign === 'center') {\n\t\t\tx -= (size.width / 2);\n\t\t}\n\n\t\tif (yAlign === 'top') {\n\t\t\ty += paddingAndSize;\n\t\t} else if (yAlign === 'bottom') {\n\t\t\ty -= size.height + paddingAndSize;\n\t\t} else {\n\t\t\ty -= (size.height / 2);\n\t\t}\n\n\t\tif (yAlign === 'center') {\n\t\t\tif (xAlign === 'left') {\n\t\t\t\tx += paddingAndSize;\n\t\t\t} else if (xAlign === 'right') {\n\t\t\t\tx -= paddingAndSize;\n\t\t\t}\n\t\t} else if (xAlign === 'left') {\n\t\t\tx -= radiusAndPadding;\n\t\t} else if (xAlign === 'right') {\n\t\t\tx += radiusAndPadding;\n\t\t}\n\n\t\treturn {\n\t\t\tx: x,\n\t\t\ty: y\n\t\t};\n\t}\n\n\tChart.Tooltip = Chart.Element.extend({\n\t\tinitialize: function() {\n\t\t\tthis._model = getBaseModel(this._options);\n\t\t},\n\n\t\t// Get the title\n\t\t// Args are: (tooltipItem, data)\n\t\tgetTitle: function() {\n\t\t\tvar me = this;\n\t\t\tvar opts = me._options;\n\t\t\tvar callbacks = opts.callbacks;\n\n\t\t\tvar beforeTitle = callbacks.beforeTitle.apply(me, arguments),\n\t\t\t\ttitle = callbacks.title.apply(me, arguments),\n\t\t\t\tafterTitle = callbacks.afterTitle.apply(me, arguments);\n\n\t\t\tvar lines = [];\n\t\t\tlines = pushOrConcat(lines, beforeTitle);\n\t\t\tlines = pushOrConcat(lines, title);\n\t\t\tlines = pushOrConcat(lines, afterTitle);\n\n\t\t\treturn lines;\n\t\t},\n\n\t\t// Args are: (tooltipItem, data)\n\t\tgetBeforeBody: function() {\n\t\t\tvar lines = this._options.callbacks.beforeBody.apply(this, arguments);\n\t\t\treturn helpers.isArray(lines) ? lines : lines !== undefined ? [lines] : [];\n\t\t},\n\n\t\t// Args are: (tooltipItem, data)\n\t\tgetBody: function(tooltipItems, data) {\n\t\t\tvar me = this;\n\t\t\tvar callbacks = me._options.callbacks;\n\t\t\tvar bodyItems = [];\n\n\t\t\thelpers.each(tooltipItems, function(tooltipItem) {\n\t\t\t\tvar bodyItem = {\n\t\t\t\t\tbefore: [],\n\t\t\t\t\tlines: [],\n\t\t\t\t\tafter: []\n\t\t\t\t};\n\t\t\t\tpushOrConcat(bodyItem.before, callbacks.beforeLabel.call(me, tooltipItem, data));\n\t\t\t\tpushOrConcat(bodyItem.lines, callbacks.label.call(me, tooltipItem, data));\n\t\t\t\tpushOrConcat(bodyItem.after, callbacks.afterLabel.call(me, tooltipItem, data));\n\n\t\t\t\tbodyItems.push(bodyItem);\n\t\t\t});\n\n\t\t\treturn bodyItems;\n\t\t},\n\n\t\t// Args are: (tooltipItem, data)\n\t\tgetAfterBody: function() {\n\t\t\tvar lines = this._options.callbacks.afterBody.apply(this, arguments);\n\t\t\treturn helpers.isArray(lines) ? lines : lines !== undefined ? [lines] : [];\n\t\t},\n\n\t\t// Get the footer and beforeFooter and afterFooter lines\n\t\t// Args are: (tooltipItem, data)\n\t\tgetFooter: function() {\n\t\t\tvar me = this;\n\t\t\tvar callbacks = me._options.callbacks;\n\n\t\t\tvar beforeFooter = callbacks.beforeFooter.apply(me, arguments);\n\t\t\tvar footer = callbacks.footer.apply(me, arguments);\n\t\t\tvar afterFooter = callbacks.afterFooter.apply(me, arguments);\n\n\t\t\tvar lines = [];\n\t\t\tlines = pushOrConcat(lines, beforeFooter);\n\t\t\tlines = pushOrConcat(lines, footer);\n\t\t\tlines = pushOrConcat(lines, afterFooter);\n\n\t\t\treturn lines;\n\t\t},\n\n\t\tupdate: function(changed) {\n\t\t\tvar me = this;\n\t\t\tvar opts = me._options;\n\n\t\t\t// Need to regenerate the model because its faster than using extend and it is necessary due to the optimization in Chart.Element.transition\n\t\t\t// that does _view = _model if ease === 1. This causes the 2nd tooltip update to set properties in both the view and model at the same time\n\t\t\t// which breaks any animations.\n\t\t\tvar existingModel = me._model;\n\t\t\tvar model = me._model = getBaseModel(opts);\n\t\t\tvar active = me._active;\n\n\t\t\tvar data = me._data;\n\t\t\tvar chartInstance = me._chartInstance;\n\n\t\t\t// In the case where active.length === 0 we need to keep these at existing values for good animations\n\t\t\tvar alignment = {\n\t\t\t\txAlign: existingModel.xAlign,\n\t\t\t\tyAlign: existingModel.yAlign\n\t\t\t};\n\t\t\tvar backgroundPoint = {\n\t\t\t\tx: existingModel.x,\n\t\t\t\ty: existingModel.y\n\t\t\t};\n\t\t\tvar tooltipSize = {\n\t\t\t\twidth: existingModel.width,\n\t\t\t\theight: existingModel.height\n\t\t\t};\n\t\t\tvar tooltipPosition = {\n\t\t\t\tx: existingModel.caretX,\n\t\t\t\ty: existingModel.caretY\n\t\t\t};\n\n\t\t\tvar i, len;\n\n\t\t\tif (active.length) {\n\t\t\t\tmodel.opacity = 1;\n\n\t\t\t\tvar labelColors = [];\n\t\t\t\ttooltipPosition = Chart.Tooltip.positioners[opts.position](active, me._eventPosition);\n\n\t\t\t\tvar tooltipItems = [];\n\t\t\t\tfor (i = 0, len = active.length; i < len; ++i) {\n\t\t\t\t\ttooltipItems.push(createTooltipItem(active[i]));\n\t\t\t\t}\n\n\t\t\t\t// If the user provided a filter function, use it to modify the tooltip items\n\t\t\t\tif (opts.filter) {\n\t\t\t\t\ttooltipItems = tooltipItems.filter(function(a) {\n\t\t\t\t\t\treturn opts.filter(a, data);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// If the user provided a sorting function, use it to modify the tooltip items\n\t\t\t\tif (opts.itemSort) {\n\t\t\t\t\ttooltipItems = tooltipItems.sort(function(a, b) {\n\t\t\t\t\t\treturn opts.itemSort(a, b, data);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Determine colors for boxes\n\t\t\t\thelpers.each(tooltipItems, function(tooltipItem) {\n\t\t\t\t\tlabelColors.push(opts.callbacks.labelColor.call(me, tooltipItem, chartInstance));\n\t\t\t\t});\n\n\t\t\t\t// Build the Text Lines\n\t\t\t\tmodel.title = me.getTitle(tooltipItems, data);\n\t\t\t\tmodel.beforeBody = me.getBeforeBody(tooltipItems, data);\n\t\t\t\tmodel.body = me.getBody(tooltipItems, data);\n\t\t\t\tmodel.afterBody = me.getAfterBody(tooltipItems, data);\n\t\t\t\tmodel.footer = me.getFooter(tooltipItems, data);\n\n\t\t\t\t// Initial positioning and colors\n\t\t\t\tmodel.x = Math.round(tooltipPosition.x);\n\t\t\t\tmodel.y = Math.round(tooltipPosition.y);\n\t\t\t\tmodel.caretPadding = helpers.getValueOrDefault(tooltipPosition.padding, 2);\n\t\t\t\tmodel.labelColors = labelColors;\n\n\t\t\t\t// data points\n\t\t\t\tmodel.dataPoints = tooltipItems;\n\n\t\t\t\t// We need to determine alignment of the tooltip\n\t\t\t\ttooltipSize = getTooltipSize(this, model);\n\t\t\t\talignment = determineAlignment(this, tooltipSize);\n\t\t\t\t// Final Size and Position\n\t\t\t\tbackgroundPoint = getBackgroundPoint(model, tooltipSize, alignment);\n\t\t\t} else {\n\t\t\t\tmodel.opacity = 0;\n\t\t\t}\n\n\t\t\tmodel.xAlign = alignment.xAlign;\n\t\t\tmodel.yAlign = alignment.yAlign;\n\t\t\tmodel.x = backgroundPoint.x;\n\t\t\tmodel.y = backgroundPoint.y;\n\t\t\tmodel.width = tooltipSize.width;\n\t\t\tmodel.height = tooltipSize.height;\n\n\t\t\t// Point where the caret on the tooltip points to\n\t\t\tmodel.caretX = tooltipPosition.x;\n\t\t\tmodel.caretY = tooltipPosition.y;\n\n\t\t\tme._model = model;\n\n\t\t\tif (changed && opts.custom) {\n\t\t\t\topts.custom.call(me, model);\n\t\t\t}\n\n\t\t\treturn me;\n\t\t},\n\t\tdrawCaret: function(tooltipPoint, size, opacity) {\n\t\t\tvar vm = this._view;\n\t\t\tvar ctx = this._chart.ctx;\n\t\t\tvar x1, x2, x3;\n\t\t\tvar y1, y2, y3;\n\t\t\tvar caretSize = vm.caretSize;\n\t\t\tvar cornerRadius = vm.cornerRadius;\n\t\t\tvar xAlign = vm.xAlign,\n\t\t\t\tyAlign = vm.yAlign;\n\t\t\tvar ptX = tooltipPoint.x,\n\t\t\t\tptY = tooltipPoint.y;\n\t\t\tvar width = size.width,\n\t\t\t\theight = size.height;\n\n\t\t\tif (yAlign === 'center') {\n\t\t\t\t// Left or right side\n\t\t\t\tif (xAlign === 'left') {\n\t\t\t\t\tx1 = ptX;\n\t\t\t\t\tx2 = x1 - caretSize;\n\t\t\t\t\tx3 = x1;\n\t\t\t\t} else {\n\t\t\t\t\tx1 = ptX + width;\n\t\t\t\t\tx2 = x1 + caretSize;\n\t\t\t\t\tx3 = x1;\n\t\t\t\t}\n\n\t\t\t\ty2 = ptY + (height / 2);\n\t\t\t\ty1 = y2 - caretSize;\n\t\t\t\ty3 = y2 + caretSize;\n\t\t\t} else {\n\t\t\t\tif (xAlign === 'left') {\n\t\t\t\t\tx1 = ptX + cornerRadius;\n\t\t\t\t\tx2 = x1 + caretSize;\n\t\t\t\t\tx3 = x2 + caretSize;\n\t\t\t\t} else if (xAlign === 'right') {\n\t\t\t\t\tx1 = ptX + width - cornerRadius;\n\t\t\t\t\tx2 = x1 - caretSize;\n\t\t\t\t\tx3 = x2 - caretSize;\n\t\t\t\t} else {\n\t\t\t\t\tx2 = ptX + (width / 2);\n\t\t\t\t\tx1 = x2 - caretSize;\n\t\t\t\t\tx3 = x2 + caretSize;\n\t\t\t\t}\n\n\t\t\t\tif (yAlign === 'top') {\n\t\t\t\t\ty1 = ptY;\n\t\t\t\t\ty2 = y1 - caretSize;\n\t\t\t\t\ty3 = y1;\n\t\t\t\t} else {\n\t\t\t\t\ty1 = ptY + height;\n\t\t\t\t\ty2 = y1 + caretSize;\n\t\t\t\t\ty3 = y1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tctx.fillStyle = mergeOpacity(vm.backgroundColor, opacity);\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(x1, y1);\n\t\t\tctx.lineTo(x2, y2);\n\t\t\tctx.lineTo(x3, y3);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t},\n\t\tdrawTitle: function(pt, vm, ctx, opacity) {\n\t\t\tvar title = vm.title;\n\n\t\t\tif (title.length) {\n\t\t\t\tctx.textAlign = vm._titleAlign;\n\t\t\t\tctx.textBaseline = 'top';\n\n\t\t\t\tvar titleFontSize = vm.titleFontSize,\n\t\t\t\t\ttitleSpacing = vm.titleSpacing;\n\n\t\t\t\tctx.fillStyle = mergeOpacity(vm.titleFontColor, opacity);\n\t\t\t\tctx.font = helpers.fontString(titleFontSize, vm._titleFontStyle, vm._titleFontFamily);\n\n\t\t\t\tvar i, len;\n\t\t\t\tfor (i = 0, len = title.length; i < len; ++i) {\n\t\t\t\t\tctx.fillText(title[i], pt.x, pt.y);\n\t\t\t\t\tpt.y += titleFontSize + titleSpacing; // Line Height and spacing\n\n\t\t\t\t\tif (i + 1 === title.length) {\n\t\t\t\t\t\tpt.y += vm.titleMarginBottom - titleSpacing; // If Last, add margin, remove spacing\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdrawBody: function(pt, vm, ctx, opacity) {\n\t\t\tvar bodyFontSize = vm.bodyFontSize;\n\t\t\tvar bodySpacing = vm.bodySpacing;\n\t\t\tvar body = vm.body;\n\n\t\t\tctx.textAlign = vm._bodyAlign;\n\t\t\tctx.textBaseline = 'top';\n\n\t\t\tvar textColor = mergeOpacity(vm.bodyFontColor, opacity);\n\t\t\tctx.fillStyle = textColor;\n\t\t\tctx.font = helpers.fontString(bodyFontSize, vm._bodyFontStyle, vm._bodyFontFamily);\n\n\t\t\t// Before Body\n\t\t\tvar xLinePadding = 0;\n\t\t\tvar fillLineOfText = function(line) {\n\t\t\t\tctx.fillText(line, pt.x + xLinePadding, pt.y);\n\t\t\t\tpt.y += bodyFontSize + bodySpacing;\n\t\t\t};\n\n\t\t\t// Before body lines\n\t\t\thelpers.each(vm.beforeBody, fillLineOfText);\n\n\t\t\tvar drawColorBoxes = vm.displayColors;\n\t\t\txLinePadding = drawColorBoxes ? (bodyFontSize + 2) : 0;\n\n\t\t\t// Draw body lines now\n\t\t\thelpers.each(body, function(bodyItem, i) {\n\t\t\t\thelpers.each(bodyItem.before, fillLineOfText);\n\n\t\t\t\thelpers.each(bodyItem.lines, function(line) {\n\t\t\t\t\t// Draw Legend-like boxes if needed\n\t\t\t\t\tif (drawColorBoxes) {\n\t\t\t\t\t\t// Fill a white rect so that colours merge nicely if the opacity is < 1\n\t\t\t\t\t\tctx.fillStyle = mergeOpacity(vm.legendColorBackground, opacity);\n\t\t\t\t\t\tctx.fillRect(pt.x, pt.y, bodyFontSize, bodyFontSize);\n\n\t\t\t\t\t\t// Border\n\t\t\t\t\t\tctx.strokeStyle = mergeOpacity(vm.labelColors[i].borderColor, opacity);\n\t\t\t\t\t\tctx.strokeRect(pt.x, pt.y, bodyFontSize, bodyFontSize);\n\n\t\t\t\t\t\t// Inner square\n\t\t\t\t\t\tctx.fillStyle = mergeOpacity(vm.labelColors[i].backgroundColor, opacity);\n\t\t\t\t\t\tctx.fillRect(pt.x + 1, pt.y + 1, bodyFontSize - 2, bodyFontSize - 2);\n\n\t\t\t\t\t\tctx.fillStyle = textColor;\n\t\t\t\t\t}\n\n\t\t\t\t\tfillLineOfText(line);\n\t\t\t\t});\n\n\t\t\t\thelpers.each(bodyItem.after, fillLineOfText);\n\t\t\t});\n\n\t\t\t// Reset back to 0 for after body\n\t\t\txLinePadding = 0;\n\n\t\t\t// After body lines\n\t\t\thelpers.each(vm.afterBody, fillLineOfText);\n\t\t\tpt.y -= bodySpacing; // Remove last body spacing\n\t\t},\n\t\tdrawFooter: function(pt, vm, ctx, opacity) {\n\t\t\tvar footer = vm.footer;\n\n\t\t\tif (footer.length) {\n\t\t\t\tpt.y += vm.footerMarginTop;\n\n\t\t\t\tctx.textAlign = vm._footerAlign;\n\t\t\t\tctx.textBaseline = 'top';\n\n\t\t\t\tctx.fillStyle = mergeOpacity(vm.footerFontColor, opacity);\n\t\t\t\tctx.font = helpers.fontString(vm.footerFontSize, vm._footerFontStyle, vm._footerFontFamily);\n\n\t\t\t\thelpers.each(footer, function(line) {\n\t\t\t\t\tctx.fillText(line, pt.x, pt.y);\n\t\t\t\t\tpt.y += vm.footerFontSize + vm.footerSpacing;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tdrawBackground: function(pt, vm, ctx, tooltipSize, opacity) {\n\t\t\tctx.fillStyle = mergeOpacity(vm.backgroundColor, opacity);\n\t\t\thelpers.drawRoundedRectangle(ctx, pt.x, pt.y, tooltipSize.width, tooltipSize.height, vm.cornerRadius);\n\t\t\tctx.fill();\n\t\t},\n\t\tdraw: function() {\n\t\t\tvar ctx = this._chart.ctx;\n\t\t\tvar vm = this._view;\n\n\t\t\tif (vm.opacity === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar tooltipSize = {\n\t\t\t\twidth: vm.width,\n\t\t\t\theight: vm.height\n\t\t\t};\n\t\t\tvar pt = {\n\t\t\t\tx: vm.x,\n\t\t\t\ty: vm.y\n\t\t\t};\n\n\t\t\t// IE11/Edge does not like very small opacities, so snap to 0\n\t\t\tvar opacity = Math.abs(vm.opacity < 1e-3) ? 0 : vm.opacity;\n\n\t\t\tif (this._options.enabled) {\n\t\t\t\t// Draw Background\n\t\t\t\tthis.drawBackground(pt, vm, ctx, tooltipSize, opacity);\n\n\t\t\t\t// Draw Caret\n\t\t\t\tthis.drawCaret(pt, tooltipSize, opacity);\n\n\t\t\t\t// Draw Title, Body, and Footer\n\t\t\t\tpt.x += vm.xPadding;\n\t\t\t\tpt.y += vm.yPadding;\n\n\t\t\t\t// Titles\n\t\t\t\tthis.drawTitle(pt, vm, ctx, opacity);\n\n\t\t\t\t// Body\n\t\t\t\tthis.drawBody(pt, vm, ctx, opacity);\n\n\t\t\t\t// Footer\n\t\t\t\tthis.drawFooter(pt, vm, ctx, opacity);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Handle an event\n\t\t * @private\n\t\t * @param {IEvent} event - The event to handle\n\t\t * @returns {Boolean} true if the tooltip changed\n\t\t */\n\t\thandleEvent: function(e) {\n\t\t\tvar me = this;\n\t\t\tvar options = me._options;\n\t\t\tvar changed = false;\n\n\t\t\tme._lastActive = me._lastActive || [];\n\n\t\t\t// Find Active Elements for tooltips\n\t\t\tif (e.type === 'mouseout') {\n\t\t\t\tme._active = [];\n\t\t\t} else {\n\t\t\t\tme._active = me._chartInstance.getElementsAtEventForMode(e, options.mode, options);\n\t\t\t}\n\n\t\t\t// Remember Last Actives\n\t\t\tchanged = !helpers.arrayEquals(me._active, me._lastActive);\n\t\t\tme._lastActive = me._active;\n\n\t\t\tif (options.enabled || options.custom) {\n\t\t\t\tme._eventPosition = {\n\t\t\t\t\tx: e.x,\n\t\t\t\t\ty: e.y\n\t\t\t\t};\n\n\t\t\t\tvar model = me._model;\n\t\t\t\tme.update(true);\n\t\t\t\tme.pivot();\n\n\t\t\t\t// See if our tooltip position changed\n\t\t\t\tchanged |= (model.x !== me._model.x) || (model.y !== me._model.y);\n\t\t\t}\n\n\t\t\treturn changed;\n\t\t}\n\t});\n\n\t/**\n\t * @namespace Chart.Tooltip.positioners\n\t */\n\tChart.Tooltip.positioners = {\n\t\t/**\n\t\t * Average mode places the tooltip at the average position of the elements shown\n\t\t * @function Chart.Tooltip.positioners.average\n\t\t * @param elements {ChartElement[]} the elements being displayed in the tooltip\n\t\t * @returns {Point} tooltip position\n\t\t */\n\t\taverage: function(elements) {\n\t\t\tif (!elements.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar i, len;\n\t\t\tvar x = 0;\n\t\t\tvar y = 0;\n\t\t\tvar count = 0;\n\n\t\t\tfor (i = 0, len = elements.length; i < len; ++i) {\n\t\t\t\tvar el = elements[i];\n\t\t\t\tif (el && el.hasValue()) {\n\t\t\t\t\tvar pos = el.tooltipPosition();\n\t\t\t\t\tx += pos.x;\n\t\t\t\t\ty += pos.y;\n\t\t\t\t\t++count;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tx: Math.round(x / count),\n\t\t\t\ty: Math.round(y / count)\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * Gets the tooltip position nearest of the item nearest to the event position\n\t\t * @function Chart.Tooltip.positioners.nearest\n\t\t * @param elements {Chart.Element[]} the tooltip elements\n\t\t * @param eventPosition {Point} the position of the event in canvas coordinates\n\t\t * @returns {Point} the tooltip position\n\t\t */\n\t\tnearest: function(elements, eventPosition) {\n\t\t\tvar x = eventPosition.x;\n\t\t\tvar y = eventPosition.y;\n\n\t\t\tvar nearestElement;\n\t\t\tvar minDistance = Number.POSITIVE_INFINITY;\n\t\t\tvar i, len;\n\t\t\tfor (i = 0, len = elements.length; i < len; ++i) {\n\t\t\t\tvar el = elements[i];\n\t\t\t\tif (el && el.hasValue()) {\n\t\t\t\t\tvar center = el.getCenterPoint();\n\t\t\t\t\tvar d = helpers.distanceBetweenPoints(eventPosition, center);\n\n\t\t\t\t\tif (d < minDistance) {\n\t\t\t\t\t\tminDistance = d;\n\t\t\t\t\t\tnearestElement = el;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (nearestElement) {\n\t\t\t\tvar tp = nearestElement.tooltipPosition();\n\t\t\t\tx = tp.x;\n\t\t\t\ty = tp.y;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t};\n\t\t}\n\t};\n};\n"]},"metadata":{},"sourceType":"script"}