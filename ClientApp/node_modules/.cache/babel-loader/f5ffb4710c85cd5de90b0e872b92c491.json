{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Kronos\\\\Documents\\\\Programming\\\\Web\\\\React\\\\CS-3750-Project\\\\ClientApp\\\\src\\\\context\\\\AuthProvider.js\";\n// reference: https://www.youtube.com/watch?v=XuFDcZABiDQ\nimport axios from \"axios\";\nimport React, { Component, createContext } from \"react\";\nimport { AccountType } from \"../helpers/helpers\";\nconst initialState = {\n  user: {\n    // setting initial state like this makes for better autocompletion\n    firstName: undefined,\n    lastName: undefined,\n    email: undefined,\n    birthDay: undefined,\n    accountType: undefined,\n    phoneNumber: undefined,\n    bio: undefined,\n    address: {\n      addressId: undefined,\n      addressOne: undefined,\n      addressTwo: undefined,\n      city: undefined,\n      state: undefined,\n      zipCode: undefined,\n      userId: undefined\n    },\n    profilePicName: undefined,\n    // fileUploads: [{}],\n    profileLinks: [{\n      profileLinkId: undefined,\n      link: undefined,\n      userId: undefined\n    }]\n  },\n  loading: true\n}; // Create context\n\nexport const AuthContext = createContext(initialState); // Provider component\n\nclass AuthProvider extends Component {\n  constructor(props) {\n    super(props);\n\n    this.setResponseToken = res => {\n      localStorage.setItem(\"authToken\", res.data.authToken);\n      window.location = \"/\";\n    };\n\n    this.setUser = async () => {\n      try {\n        const user = await this.getCurrentUserInfo();\n        this.setState({\n          user,\n          loading: false\n        });\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.getCurrentUserInfo = async () => {\n      try {\n        const authHeader = this.authHeader();\n        if (!authHeader) return null;\n        const res = await axios.get(\"api/users/current\", authHeader);\n        return res.data;\n      } catch (err) {\n        console.error(err);\n        localStorage.removeItem(\"authToken\");\n        return null;\n      }\n    };\n\n    this.login = ({\n      email,\n      password\n    }) => {\n      return axios.post(\"api/auth/login\", {\n        email,\n        password\n      }).then(res => {\n        this.setResponseToken(res);\n      }).catch(err => {\n        alert(`${err.message}:\\n${err.response.data.error}`);\n      });\n    };\n\n    this.logout = () => {\n      localStorage.removeItem(\"authToken\");\n      window.location = \"/\";\n    };\n\n    this.signup = userInfo => {\n      axios.post(\"api/auth/signup\", userInfo).then(res => {\n        this.setResponseToken(res);\n      }).catch(err => {\n        alert(err.message);\n        console.error(err.message);\n      });\n    };\n\n    this.authHeader = () => {\n      const authToken = localStorage.getItem(\"authToken\");\n      if (!authToken) return null;\n      return {\n        headers: {\n          Authorization: `Bearer ${authToken}`\n        }\n      };\n    };\n\n    this.updateUser = user => {\n      this.setState({\n        user\n      });\n    };\n\n    this.state = initialState;\n  }\n\n  async componentDidMount() {\n    this.setUser();\n  }\n\n  render() {\n    const {\n      user,\n      loading\n    } = this.state;\n    const {\n      children\n    } = this.props;\n    return !loading && /*#__PURE__*/React.createElement(AuthContext.Provider, {\n      value: {\n        user,\n        login: this.login,\n        logout: this.logout,\n        signup: this.signup,\n        authHeader: this.authHeader(),\n        isStudent: (user === null || user === void 0 ? void 0 : user.accountType) === AccountType.STUDENT,\n        isInstructor: (user === null || user === void 0 ? void 0 : user.accountType) === AccountType.INSTRUCTOR,\n        updateUser: this.updateUser\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }\n    }, children);\n  }\n\n}\n\nexport default AuthProvider;","map":{"version":3,"sources":["C:/Users/Kronos/Documents/Programming/Web/React/CS-3750-Project/ClientApp/src/context/AuthProvider.js"],"names":["axios","React","Component","createContext","AccountType","initialState","user","firstName","undefined","lastName","email","birthDay","accountType","phoneNumber","bio","address","addressId","addressOne","addressTwo","city","state","zipCode","userId","profilePicName","profileLinks","profileLinkId","link","loading","AuthContext","AuthProvider","constructor","props","setResponseToken","res","localStorage","setItem","data","authToken","window","location","setUser","getCurrentUserInfo","setState","err","console","log","authHeader","get","error","removeItem","login","password","post","then","catch","alert","message","response","logout","signup","userInfo","getItem","headers","Authorization","updateUser","componentDidMount","render","children","isStudent","STUDENT","isInstructor","INSTRUCTOR"],"mappings":"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","sourcesContent":["// reference: https://www.youtube.com/watch?v=XuFDcZABiDQ\r\nimport axios from \"axios\";\r\nimport React, { Component, createContext } from \"react\";\r\nimport { AccountType } from \"../helpers/helpers\";\r\n\r\nconst initialState = {\r\n    user: {\r\n        // setting initial state like this makes for better autocompletion\r\n        firstName: undefined,\r\n        lastName: undefined,\r\n        email: undefined,\r\n        birthDay: undefined,\r\n        accountType: undefined,\r\n        phoneNumber: undefined,\r\n        bio: undefined,\r\n        address: {\r\n            addressId: undefined,\r\n            addressOne: undefined,\r\n            addressTwo: undefined,\r\n            city: undefined,\r\n            state: undefined,\r\n            zipCode: undefined,\r\n            userId: undefined\r\n        },\r\n        profilePicName: undefined,\r\n        // fileUploads: [{}],\r\n        profileLinks: [\r\n            {\r\n                profileLinkId: undefined,\r\n                link: undefined,\r\n                userId: undefined\r\n            }\r\n        ]\r\n    },\r\n    loading: true\r\n};\r\n\r\n// Create context\r\nexport const AuthContext = createContext(initialState);\r\n\r\n// Provider component\r\nclass AuthProvider extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = initialState;\r\n    }\r\n\r\n    async componentDidMount() {\r\n        this.setUser();\r\n    }\r\n\r\n    setResponseToken = res => {\r\n        localStorage.setItem(\"authToken\", res.data.authToken);\r\n        window.location = \"/\";\r\n    };\r\n\r\n    setUser = async () => {\r\n        try {\r\n            const user = await this.getCurrentUserInfo();\r\n            this.setState({ user, loading: false });\r\n        } catch (err) {\r\n            console.log(err);\r\n        }\r\n    };\r\n\r\n    getCurrentUserInfo = async () => {\r\n        try {\r\n            const authHeader = this.authHeader();\r\n            if (!authHeader) return null;\r\n\r\n            const res = await axios.get(\"api/users/current\", authHeader);\r\n\r\n            return res.data;\r\n        } catch (err) {\r\n            console.error(err);\r\n            localStorage.removeItem(\"authToken\");\r\n            return null;\r\n        }\r\n    };\r\n\r\n    login = ({ email, password }) => {\r\n        return axios\r\n            .post(\"api/auth/login\", { email, password })\r\n            .then(res => {\r\n                this.setResponseToken(res);\r\n            })\r\n            .catch(err => {\r\n                alert(`${err.message}:\\n${err.response.data.error}`);\r\n            });\r\n    };\r\n\r\n    logout = () => {\r\n        localStorage.removeItem(\"authToken\");\r\n        window.location = \"/\";\r\n    };\r\n\r\n    signup = userInfo => {\r\n        axios\r\n            .post(\"api/auth/signup\", userInfo)\r\n            .then(res => {\r\n                this.setResponseToken(res);\r\n            })\r\n            .catch(err => {\r\n                alert(err.message);\r\n                console.error(err.message);\r\n            });\r\n    };\r\n\r\n    authHeader = () => {\r\n        const authToken = localStorage.getItem(\"authToken\");\r\n        if (!authToken) return null;\r\n        return { headers: { Authorization: `Bearer ${authToken}` } };\r\n    };\r\n\r\n    updateUser = user => {\r\n        this.setState({ user });\r\n    };\r\n\r\n    render() {\r\n        const { user, loading } = this.state;\r\n        const { children } = this.props;\r\n\r\n        return (\r\n            !loading && (\r\n                <AuthContext.Provider\r\n                    value={{\r\n                        user,\r\n                        login: this.login,\r\n                        logout: this.logout,\r\n                        signup: this.signup,\r\n                        authHeader: this.authHeader(),\r\n                        isStudent: user?.accountType === AccountType.STUDENT,\r\n                        isInstructor:\r\n                            user?.accountType === AccountType.INSTRUCTOR,\r\n                        updateUser: this.updateUser\r\n                    }}\r\n                >\r\n                    {children}\r\n                </AuthContext.Provider>\r\n            )\r\n        );\r\n    }\r\n}\r\n\r\nexport default AuthProvider;\r\n"]},"metadata":{},"sourceType":"module"}